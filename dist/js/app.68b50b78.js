(function(e){function n(n){for(var a,c,i=n[0],s=n[1],l=n[2],f=0,d=[];f<i.length;f++)c=i[f],Object.prototype.hasOwnProperty.call(o,c)&&o[c]&&d.push(o[c][0]),o[c]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a]);u&&u(n);while(d.length)d.shift()();return r.push.apply(r,l||[]),t()}function t(){for(var e,n=0;n<r.length;n++){for(var t=r[n],a=!0,i=1;i<t.length;i++){var s=t[i];0!==o[s]&&(a=!1)}a&&(r.splice(n--,1),e=c(c.s=t[0]))}return e}var a={},o={app:0},r=[];function c(n){if(a[n])return a[n].exports;var t=a[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,c),t.l=!0,t.exports}c.m=e,c.c=a,c.d=function(e,n,t){c.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,n){if(1&n&&(e=c(e)),8&n)return e;if(4&n&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(c.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var a in e)c.d(t,a,function(n){return e[n]}.bind(null,a));return t},c.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(n,"a",n),n},c.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},c.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],s=i.push.bind(i);i.push=n,i=i.slice();for(var l=0;l<i.length;l++)n(i[l]);var u=s;r.push([0,"chunk-vendors"]),t()})({0:function(e,n,t){e.exports=t("56d7")},1:function(e,n){},2:function(e,n){},3:function(e,n){},"56d7":function(e,n,t){"use strict";t.r(n);t("e260"),t("e6cf"),t("cca6"),t("a79d");var a=t("2b0e"),o=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("v-app",[t("v-app-bar",{attrs:{app:"",color:"dark",dark:""}},[t("div",{staticClass:"d-flex align-center"},[t("v-img",{staticClass:"shrink mr-2",attrs:{alt:"Vuetify Logo",contain:"",src:"https://cdn.vuetifyjs.com/images/logos/vuetify-logo-dark.png",transition:"scale-transition",width:"40"}}),e._v(" Roll Play Stage ")],1),t("v-spacer"),t("v-btn",{attrs:{href:"#",target:"_blank",text:""}},[t("span",{staticClass:"mr-2"},[e._v("NAME HOLDER")]),t("v-icon",[e._v("mdi-open-in-new")])],1)],1),t("v-main",[t("v-row",[t("v-col",[t("Canvas")],1),t("v-col",[t("SidePanel")],1)],1)],1)],1)},r=[],c=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("v-container",[t("div",{on:{drop:function(n){return n.preventDefault(),e.addTokenDrag(n)},dragover:function(e){e.preventDefault()}}},[t("v-card",{attrs:{width:"640"}},[t("canvas",{ref:"can",staticStyle:{border:"1px solid black"},attrs:{width:"640",height:"480"}})])],1),t("v-btn",{attrs:{disabled:!e.objectSelected},on:{click:e.removeToken}},[e._v("remove")])],1)},i=[],s=(t("159b"),t("4de4"),t("b64b"),t("b0c0"),t("bf19"),t("260b")),l=(t("66ce"),{apiKey:"AIzaSyCY2RisfrQSJ_2spRpgmTQIVXCpHMKUBI8",authDomain:"roll-play-stage.firebaseapp.com",projectId:"roll-play-stage",storageBucket:"roll-play-stage.appspot.com",messagingSenderId:"1021674062807",appId:"1:1021674062807:web:11171850dd1eb9fff00192"}),u=s["a"].initializeApp(l),f=u,d=t("7a94"),v={name:"Canvas",data:function(){return{tokenRef:{},objectSelected:!1,tokens:{},canvas:{},changing:!1}},methods:{addToken:function(){var e={name:"Goblin",url:"http://google.com/"};this.tokenRef.push(e)},removeToken:function(){var e=this,n=this.canvas.getActiveObject();if(n){var t=[];"activeSelection"==n.type?t=n._objects:t.push(n),t.forEach((function(n){var t=e.tokenRef.child(n.__id);t.remove()}))}},getTokenFromId:function(e){return this.canvas.getObjects().filter((function(n){return n.__id===e}))[0]},addTokenDrag:function(e){var n=this,t=e.dataTransfer.getData("Text"),a=new Image;a.addEventListener("load",(function(a){var o=a.target.naturalWidth,r=a.target.naturalHeight,c="token_"+Object.keys(n.tokens).length,i={name:c,url:t,top:e.clientY-r/2,left:e.clientX-o/2,angle:0,scaleX:1,scaleY:1};n.tokenRef.push(i)})),a.src=t}},mounted:function(){var e=this,n=this.$refs.can;this.canvas=new d["fabric"].Canvas(n,{fireRightClick:!0,fireMiddleClick:!0,stopContextMenu:!0}),this.tokenRef=f.database().ref("tokens"),this.tokenRef.on("value",(function(n){var t=n.val();if(t){var a=[];Object.keys(t).forEach((function(e){a.push({__id:e,name:t[e].name,url:t[e].url})})),e.tokens=a}})),this.tokenRef.on("child_added",(function(n){console.log("CHILD_ADDED",n.val().url);var t=n.val();d["fabric"].Image.fromURL(t.url,(function(a){e.canvas.add(a).setActiveObject(a),a.set({__id:n.key,top:t.top,left:t.left,scaleX:t.scaleX,scaleY:t.scaleY,angle:t.angle}),a.setCoords()}))})),this.canvas.on("selection:created",(function(){console.log("object selected"),e.objectSelected=!0})),this.canvas.on("selection:cleared",(function(){console.log("object deselected"),e.objectSelected=!1})),this.canvas.on("object:moving",(function(){e.changing=!0})),this.canvas.on("object:rotating",(function(){e.changing=!0})),this.canvas.on("object:scaling",(function(){e.changing=!0})),this.canvas.on("object:modified",(function(n){if(e.changing){console.log("im here now again");var t=[];if(void 0!=n.target._objects){var a=e.canvas.getActiveObjects(),o=e.canvas.toJSON(["__id"]).objects;a.forEach((function(e){o.forEach((function(n){e.__id===n.__id&&t.push(n)}))}))}else t.push(n.target);t.forEach((function(n){var t=e.tokenRef.child(n.__id),a={top:n.top,left:n.left,scaleX:n.scaleX,scaleY:n.scaleY,angle:n.angle};console.log(a),t.update(a)})),e.changing=!1}})),this.tokenRef.on("child_removed",(function(n){console.log("CHILD_REMOVED");var t=n.key;console.log(t);var a=e.getTokenFromId(t);e.canvas.remove(a)})),this.tokenRef.on("child_changed",(function(n){if(!e.changing){e.canvas.discardActiveObject();var t=n.val(),a=n.key;for(var o in e.canvas._objects)e.canvas._objects[o].__id===a&&(e.canvas._objects[o].animate("left",t.left,{}),e.canvas._objects[o].animate("top",t.top,{onChange:e.canvas.renderAll.bind(e.canvas)}),e.canvas._objects[o].set({scaleX:t.scaleX,scaleY:t.scaleY,angle:t.angle}),e.canvas._objects[o].setCoords(),e.canvas.requestRenderAll())}}))}},p=v,g=t("2877"),h=t("6544"),b=t.n(h),m=t("8336"),_=t("b0af"),k=t("a523"),j=Object(g["a"])(p,c,i,!1,null,null,null),y=j.exports;b()(j,{VBtn:m["a"],VCard:_["a"],VContainer:k["a"]});var O=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("v-container",e._l(e.images,(function(e,n){return t("div",{key:n},[t("img",{attrs:{height:"75",width:"75",src:e.url,alt:""}})])})),0)},w=[],C={name:"SidePanel",data:function(){return{images:[{name:"Donald Trump",url:"http://i.imgur.com/QcJru0b.png"},{name:"Hilary Clinton",url:"http://i.imgur.com/Yp9zAaY.png"},{name:"Bernie Sanders",url:"http://i.imgur.com/K4ZroX1.png"},{name:"Barack Obama",url:"http://i.imgur.com/j7zfXYB.png"},{name:"Joe Biden",url:"http://i.imgur.com/ZACKyqE.png"}]}}},S=C,R=Object(g["a"])(S,O,w,!1,null,null,null),V=R.exports;b()(R,{VContainer:k["a"]});var A={name:"App",components:{Canvas:y,SidePanel:V},data:function(){return{}}},E=A,x=t("7496"),D=t("40dc"),I=t("62ad"),T=t("132d"),Y=t("adda"),P=t("f6c4"),X=t("0fd9"),M=t("2fa4"),B=Object(g["a"])(E,o,r,!1,null,null,null),H=B.exports;b()(B,{VApp:x["a"],VAppBar:D["a"],VBtn:m["a"],VCol:I["a"],VIcon:T["a"],VImg:Y["a"],VMain:P["a"],VRow:X["a"],VSpacer:M["a"]});var J=t("f309");a["a"].use(J["a"]);var L=new J["a"]({theme:{dark:!0}});a["a"].config.productionTip=!1,new a["a"]({vuetify:L,render:function(e){return e(H)}}).$mount("#app")}});
//# sourceMappingURL=app.68b50b78.js.map